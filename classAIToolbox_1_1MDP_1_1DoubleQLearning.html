<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIToolbox: AIToolbox::MDP::DoubleQLearning Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIToolbox
   </div>
   <div id="projectbrief">A library that offers tools for AI problem solving.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classAIToolbox_1_1MDP_1_1DoubleQLearning.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAIToolbox_1_1MDP_1_1DoubleQLearning-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AIToolbox::MDP::DoubleQLearning Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class represents the double <a class="el" href="classAIToolbox_1_1MDP_1_1QLearning.html" title="This class represents the QLearning algorithm.">QLearning</a> algorithm.  
 <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DoubleQLearning_8hpp_source.html">AIToolbox/MDP/Algorithms/DoubleQLearning.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4ce0b5f55b9774f26c86fb0c9534a166"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a4ce0b5f55b9774f26c86fb0c9534a166">DoubleQLearning</a> (size_t S, size_t A, double discount=1.0, double alpha=0.1)</td></tr>
<tr class="memdesc:a4ce0b5f55b9774f26c86fb0c9534a166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a4ce0b5f55b9774f26c86fb0c9534a166">More...</a><br /></td></tr>
<tr class="separator:a4ce0b5f55b9774f26c86fb0c9534a166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0ee11dc757a1341b95f0759be96bbf"><td class="memTemplParams" colspan="2">template&lt;typename M , typename  = std::enable_if_t&lt;is_generative_model_v&lt;M&gt;&gt;&gt; </td></tr>
<tr class="memitem:a0b0ee11dc757a1341b95f0759be96bbf"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a0b0ee11dc757a1341b95f0759be96bbf">DoubleQLearning</a> (const M &amp;model, double alpha=0.1)</td></tr>
<tr class="memdesc:a0b0ee11dc757a1341b95f0759be96bbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a0b0ee11dc757a1341b95f0759be96bbf">More...</a><br /></td></tr>
<tr class="separator:a0b0ee11dc757a1341b95f0759be96bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae75d18afd3decfc6c9b2e1769ed3e137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ae75d18afd3decfc6c9b2e1769ed3e137">setLearningRate</a> (double a)</td></tr>
<tr class="memdesc:ae75d18afd3decfc6c9b2e1769ed3e137"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the learning rate parameter.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ae75d18afd3decfc6c9b2e1769ed3e137">More...</a><br /></td></tr>
<tr class="separator:ae75d18afd3decfc6c9b2e1769ed3e137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b58efb6a2a5f664d2b4a1cdd7dd738b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a5b58efb6a2a5f664d2b4a1cdd7dd738b">getLearningRate</a> () const</td></tr>
<tr class="memdesc:a5b58efb6a2a5f664d2b4a1cdd7dd738b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will return the current set learning rate parameter.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a5b58efb6a2a5f664d2b4a1cdd7dd738b">More...</a><br /></td></tr>
<tr class="separator:a5b58efb6a2a5f664d2b4a1cdd7dd738b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48690305270bf450117f391787321b70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a48690305270bf450117f391787321b70">setDiscount</a> (double d)</td></tr>
<tr class="memdesc:a48690305270bf450117f391787321b70"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the new discount parameter.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a48690305270bf450117f391787321b70">More...</a><br /></td></tr>
<tr class="separator:a48690305270bf450117f391787321b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29876cadf4888de79b2b2e3fdd1b9a50"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a29876cadf4888de79b2b2e3fdd1b9a50">getDiscount</a> () const</td></tr>
<tr class="memdesc:a29876cadf4888de79b2b2e3fdd1b9a50"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the currently set discount parameter.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a29876cadf4888de79b2b2e3fdd1b9a50">More...</a><br /></td></tr>
<tr class="separator:a29876cadf4888de79b2b2e3fdd1b9a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a336753c87599d6ae934636535f01e795"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a336753c87599d6ae934636535f01e795">stepUpdateQ</a> (size_t s, size_t a, size_t s1, double rew)</td></tr>
<tr class="memdesc:a336753c87599d6ae934636535f01e795"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function updates the internal QFunction using the discount set during construction.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a336753c87599d6ae934636535f01e795">More...</a><br /></td></tr>
<tr class="separator:a336753c87599d6ae934636535f01e795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14e5e4d87ec6c90d0ba55eacd7339c8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ab14e5e4d87ec6c90d0ba55eacd7339c8">getS</a> () const</td></tr>
<tr class="memdesc:ab14e5e4d87ec6c90d0ba55eacd7339c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of states on which <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> is working.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ab14e5e4d87ec6c90d0ba55eacd7339c8">More...</a><br /></td></tr>
<tr class="separator:ab14e5e4d87ec6c90d0ba55eacd7339c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bb7412bdd9e4cef6bed01c638b46a2a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a9bb7412bdd9e4cef6bed01c638b46a2a">getA</a> () const</td></tr>
<tr class="memdesc:a9bb7412bdd9e4cef6bed01c638b46a2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of actions on which <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> is working.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a9bb7412bdd9e4cef6bed01c638b46a2a">More...</a><br /></td></tr>
<tr class="separator:a9bb7412bdd9e4cef6bed01c638b46a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d378105ecc7bf0c1566fe7019acac9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ab7d378105ecc7bf0c1566fe7019acac9">getQFunction</a> () const</td></tr>
<tr class="memdesc:ab7d378105ecc7bf0c1566fe7019acac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a reference to the internal "sum" QFunction.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ab7d378105ecc7bf0c1566fe7019acac9">More...</a><br /></td></tr>
<tr class="separator:ab7d378105ecc7bf0c1566fe7019acac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283b004d4d74193614b81c3121a54fae"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a283b004d4d74193614b81c3121a54fae">getQFunctionA</a> () const</td></tr>
<tr class="memdesc:a283b004d4d74193614b81c3121a54fae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a reference to the first internal QFunction.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a283b004d4d74193614b81c3121a54fae">More...</a><br /></td></tr>
<tr class="separator:a283b004d4d74193614b81c3121a54fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298af99c5d90203b52a7307baa3df8eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a298af99c5d90203b52a7307baa3df8eb">getQFunctionB</a> () const</td></tr>
<tr class="memdesc:a298af99c5d90203b52a7307baa3df8eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a copy to the second QFunction.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a298af99c5d90203b52a7307baa3df8eb">More...</a><br /></td></tr>
<tr class="separator:a298af99c5d90203b52a7307baa3df8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afde00828e95434a131c245b18c531b1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#afde00828e95434a131c245b18c531b1d">setQFunction</a> (const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;qfun)</td></tr>
<tr class="memdesc:afde00828e95434a131c245b18c531b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows to directly set the internal QFunctions.  <a href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#afde00828e95434a131c245b18c531b1d">More...</a><br /></td></tr>
<tr class="separator:afde00828e95434a131c245b18c531b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class represents the double <a class="el" href="classAIToolbox_1_1MDP_1_1QLearning.html" title="This class represents the QLearning algorithm.">QLearning</a> algorithm. </p>
<p>The <a class="el" href="classAIToolbox_1_1MDP_1_1QLearning.html" title="This class represents the QLearning algorithm.">QLearning</a> algorithm is biased to overestimate the expected future reward during the Bellman equation update, as the bootstrapped max over the same QFunction is actually an unbiased estimator for the expected max, rather than the max expected.</p>
<p>This is a problem for certain classes of problems, and <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> tries to fix that.</p>
<p><a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> maintains two separate QFunctions, and in a given timestep one is selected randomly to be updated. The update has the same form as the standard <a class="el" href="classAIToolbox_1_1MDP_1_1QLearning.html" title="This class represents the QLearning algorithm.">QLearning</a> update, except that the <em>other</em> QFunction is used to estimate the expected future reward. The math shows that this technique still results in a bias estimation, but in this case we tend to underestimate.</p>
<p>We can still try to counteract this with optimistic initialization, and the final result is often more stable than simple <a class="el" href="classAIToolbox_1_1MDP_1_1QLearning.html" title="This class represents the QLearning algorithm.">QLearning</a>.</p>
<p>Since action selection should be performed w.r.t. both QFunctions, <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> stores two things: the first QFunction, and the sum between the first QFunction and the second. The second QFunction is not stored explicitly, and is instead always computed on-the-fly when needed.</p>
<p>We do this so we can easily return the sum of both QFunction to apply a <a class="el" href="classAIToolbox_1_1MDP_1_1Policy.html" title="This class represents an MDP Policy.">Policy</a> to, without the need to store three separate QFunctions explicitly (lowering a bit the memory requirements).</p>
<p>If you are interested in the actual values stored in the two "main" QFunctions, please use <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a283b004d4d74193614b81c3121a54fae" title="This function returns a reference to the first internal QFunction.">getQFunctionA()</a> and <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a298af99c5d90203b52a7307baa3df8eb" title="This function returns a copy to the second QFunction.">getQFunctionB()</a>. Note that <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#a298af99c5d90203b52a7307baa3df8eb" title="This function returns a copy to the second QFunction.">getQFunctionB()</a> will not return a reference! </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4ce0b5f55b9774f26c86fb0c9534a166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ce0b5f55b9774f26c86fb0c9534a166">&#9670;&nbsp;</a></span>DoubleQLearning() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AIToolbox::MDP::DoubleQLearning::DoubleQLearning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>discount</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>0.1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<p>The learning rate must be &gt; 0.0 and &lt;= 1.0, otherwise the constructor will throw an std::invalid_argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S</td><td>The size of the state space. </td></tr>
    <tr><td class="paramname">A</td><td>The size of the action space. </td></tr>
    <tr><td class="paramname">discount</td><td>The discount to use when learning. </td></tr>
    <tr><td class="paramname">alpha</td><td>The learning rate of the <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0b0ee11dc757a1341b95f0759be96bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0ee11dc757a1341b95f0759be96bbf">&#9670;&nbsp;</a></span>DoubleQLearning() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename M , typename &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">AIToolbox::MDP::DoubleQLearning::DoubleQLearning </td>
          <td>(</td>
          <td class="paramtype">const M &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>0.1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<p>The learning rate must be &gt; 0.0 and &lt;= 1.0, otherwise the constructor will throw an std::invalid_argument.</p>
<p>This constructor copies the S and A and discount parameters from the supplied model. It does not keep the reference, so if the discount needs to change you'll need to update it here manually too.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>The <a class="el" href="namespaceAIToolbox_1_1MDP.html">MDP</a> model that <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> will use as a base. </td></tr>
    <tr><td class="paramname">alpha</td><td>The learning rate of the <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9bb7412bdd9e4cef6bed01c638b46a2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bb7412bdd9e4cef6bed01c638b46a2a">&#9670;&nbsp;</a></span>getA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t AIToolbox::MDP::DoubleQLearning::getA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the number of actions on which <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> is working. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of actions. </dd></dl>

</div>
</div>
<a id="a29876cadf4888de79b2b2e3fdd1b9a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29876cadf4888de79b2b2e3fdd1b9a50">&#9670;&nbsp;</a></span>getDiscount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AIToolbox::MDP::DoubleQLearning::getDiscount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the currently set discount parameter. </p>
<dl class="section return"><dt>Returns</dt><dd>The currently set discount parameter. </dd></dl>

</div>
</div>
<a id="a5b58efb6a2a5f664d2b4a1cdd7dd738b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b58efb6a2a5f664d2b4a1cdd7dd738b">&#9670;&nbsp;</a></span>getLearningRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AIToolbox::MDP::DoubleQLearning::getLearningRate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will return the current set learning rate parameter. </p>
<dl class="section return"><dt>Returns</dt><dd>The currently set learning rate parameter. </dd></dl>

</div>
</div>
<a id="ab7d378105ecc7bf0c1566fe7019acac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d378105ecc7bf0c1566fe7019acac9">&#9670;&nbsp;</a></span>getQFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a>&amp; AIToolbox::MDP::DoubleQLearning::getQFunction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a reference to the internal "sum" QFunction. </p>
<p>The QFunction that is returned does not contain "true" values, but instead is the sum of the two QFunctions that are being updated by <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a>. This is to make it possible to select actions using standard policy classes.</p>
<p>The returned reference can be used to build Policies, for example <a class="el" href="classAIToolbox_1_1MDP_1_1QGreedyPolicy.html" title="This class models a greedy policy through a QFunction.">MDP::QGreedyPolicy</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>The internal "sum" QFunction. </dd></dl>

</div>
</div>
<a id="a283b004d4d74193614b81c3121a54fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a283b004d4d74193614b81c3121a54fae">&#9670;&nbsp;</a></span>getQFunctionA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a>&amp; AIToolbox::MDP::DoubleQLearning::getQFunctionA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a reference to the first internal QFunction. </p>
<p>The returned reference can be used to build Policies, for example <a class="el" href="classAIToolbox_1_1MDP_1_1QGreedyPolicy.html" title="This class models a greedy policy through a QFunction.">MDP::QGreedyPolicy</a>, but you should probably use <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html#ab7d378105ecc7bf0c1566fe7019acac9" title="This function returns a reference to the internal &quot;sum&quot; QFunction.">getQFunction()</a> for that.</p>
<dl class="section return"><dt>Returns</dt><dd>The internal first QFunction. </dd></dl>

</div>
</div>
<a id="a298af99c5d90203b52a7307baa3df8eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298af99c5d90203b52a7307baa3df8eb">&#9670;&nbsp;</a></span>getQFunctionB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> AIToolbox::MDP::DoubleQLearning::getQFunctionB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a copy to the second QFunction. </p>
<p>This QFunction is constructed on the fly, and so is not returned by reference!</p>
<dl class="section return"><dt>Returns</dt><dd>What the second QFunction should be. </dd></dl>

</div>
</div>
<a id="ab14e5e4d87ec6c90d0ba55eacd7339c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14e5e4d87ec6c90d0ba55eacd7339c8">&#9670;&nbsp;</a></span>getS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t AIToolbox::MDP::DoubleQLearning::getS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the number of states on which <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> is working. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of states. </dd></dl>

</div>
</div>
<a id="a48690305270bf450117f391787321b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48690305270bf450117f391787321b70">&#9670;&nbsp;</a></span>setDiscount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::DoubleQLearning::setDiscount </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the new discount parameter. </p>
<p>The discount parameter controls the amount that future rewards are considered by <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a>. If 1, then any reward is the same, if obtained now or in a million timesteps. Thus the algorithm will optimize overall reward accretion. When less than 1, rewards obtained in the presents are valued more than future rewards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The new discount factor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae75d18afd3decfc6c9b2e1769ed3e137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae75d18afd3decfc6c9b2e1769ed3e137">&#9670;&nbsp;</a></span>setLearningRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::DoubleQLearning::setLearningRate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the learning rate parameter. </p>
<p>The learning parameter determines the speed at which the QFunction is modified with respect to new data. In fully deterministic environments (such as an agent moving through a grid, for example), this parameter can be safely set to 1.0 for maximum learning.</p>
<p>On the other side, in stochastic environments, in order to converge this parameter should be higher when first starting to learn, and decrease slowly over time.</p>
<p>Otherwise it can be kept somewhat high if the environment dynamics change progressively, and the algorithm will adapt accordingly. The final behavior of <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> is very dependent on this parameter.</p>
<p>The learning rate parameter must be &gt; 0.0 and &lt;= 1.0, otherwise the function will throw an std::invalid_argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The new learning rate parameter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afde00828e95434a131c245b18c531b1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afde00828e95434a131c245b18c531b1d">&#9670;&nbsp;</a></span>setQFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::DoubleQLearning::setQFunction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td>
          <td class="paramname"><em>qfun</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows to directly set the internal QFunctions. </p>
<p>This can be useful in order to use a QFunction that has already been computed elsewhere. <a class="el" href="classAIToolbox_1_1MDP_1_1DoubleQLearning.html" title="This class represents the double QLearning algorithm.">DoubleQLearning</a> will then continue building upon it.</p>
<p>Both first and second interal QFunctions are set to the input, while the "sum" QFunction is set to double the input.</p>
<p>This is used for example in the <a class="el" href="classAIToolbox_1_1MDP_1_1Dyna2.html" title="This class represents the Dyna2 algorithm.">Dyna2</a> algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qfun</td><td>The new QFunction to set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a336753c87599d6ae934636535f01e795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a336753c87599d6ae934636535f01e795">&#9670;&nbsp;</a></span>stepUpdateQ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::DoubleQLearning::stepUpdateQ </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function updates the internal QFunction using the discount set during construction. </p>
<p>This function takes a single experience point and uses it to update the QFunction. This is a very efficient method to keep the QFunction up to date with the latest experience.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The previous state. </td></tr>
    <tr><td class="paramname">a</td><td>The action performed. </td></tr>
    <tr><td class="paramname">s1</td><td>The new state. </td></tr>
    <tr><td class="paramname">rew</td><td>The reward obtained. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/AIToolbox/MDP/Algorithms/<a class="el" href="DoubleQLearning_8hpp_source.html">DoubleQLearning.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
