cmake_minimum_required (VERSION 2.6)

function (AddTestMDP name)
    set(exename MDP_${name})
    add_executable(${exename}Tests MDP/${name}Tests.cpp)
    target_link_libraries(${exename}Tests AIToolboxMDP ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY} ${ARGN})
    add_test(NAME ${exename} WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY} COMMAND $<TARGET_FILE:${exename}Tests>)
endfunction (AddTestMDP)

function (AddTestPOMDP name)
    set(exename POMDP_${name})
    add_executable(${exename}Tests POMDP/${name}Tests.cpp)
    target_link_libraries(${exename}Tests AIToolboxMDP AIToolboxPOMDP ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY} ${ARGN})
    add_test(NAME ${exename} WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY} COMMAND $<TARGET_FILE:${exename}Tests>)
endfunction (AddTestPOMDP)

if (MAKE_MDP)
    find_package(Boost 1.53 COMPONENTS unit_test_framework REQUIRED)
    include_directories(${Boost_INCLUDE_DIRS})

    find_package(Eigen3 REQUIRED)
    include_directories(${EIGEN3_INCLUDE_DIR})

    AddTestMDP(Experience)
    AddTestMDP(MCTS)
    AddTestMDP(Model)
    AddTestMDP(PrioritizedSweeping)
    AddTestMDP(QLearning)
    AddTestMDP(RLModel)
    AddTestMDP(SARSA)
    AddTestMDP(SparseModel)
    AddTestMDP(SparseRLModel)
    AddTestMDP(ValueIteration)
    AddTestMDP(WoLFPolicy)
endif()

if (MAKE_POMDP)
    AddTestPOMDP(AMDP)
    AddTestPOMDP(IncrementalPruning)
    AddTestPOMDP(Model)
    AddTestPOMDP(PBVI)
    AddTestPOMDP(POMCP)
    AddTestPOMDP(RTBSS)
    AddTestPOMDP(SparseModel)
    AddTestPOMDP(Witness)
endif()
