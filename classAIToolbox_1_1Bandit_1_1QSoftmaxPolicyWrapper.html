<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIToolbox: AIToolbox::Bandit::QSoftmaxPolicyWrapper&lt; V, Gen &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIToolbox
   </div>
   <div id="projectbrief">A library that offers tools for AI problem solving.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AIToolbox::Bandit::QSoftmaxPolicyWrapper&lt; V, Gen &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements some basic softmax policy primitives.  
 <a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="QSoftmaxPolicyWrapper_8hpp_source.html">QSoftmaxPolicyWrapper.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a97bf2be1d43f0cfd1d8cf355ff3cadfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a97bf2be1d43f0cfd1d8cf355ff3cadfc">QSoftmaxPolicyWrapper</a> (double t, V q, <a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a> &amp;valueBuffer, std::vector&lt; size_t &gt; &amp;buffer, Gen &amp;gen)</td></tr>
<tr class="memdesc:a97bf2be1d43f0cfd1d8cf355ff3cadfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a97bf2be1d43f0cfd1d8cf355ff3cadfc">More...</a><br /></td></tr>
<tr class="separator:a97bf2be1d43f0cfd1d8cf355ff3cadfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5ea841adc833c165a89c4869355a968"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#ab5ea841adc833c165a89c4869355a968">sampleAction</a> ()</td></tr>
<tr class="memdesc:ab5ea841adc833c165a89c4869355a968"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function chooses an action for state s with probability dependent on value.  <a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#ab5ea841adc833c165a89c4869355a968">More...</a><br /></td></tr>
<tr class="separator:ab5ea841adc833c165a89c4869355a968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2715284d0c0504a041a9ab5582904158"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a2715284d0c0504a041a9ab5582904158">getActionProbability</a> (size_t a) const</td></tr>
<tr class="memdesc:a2715284d0c0504a041a9ab5582904158"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the probability of taking the specified action in the specified state.  <a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a2715284d0c0504a041a9ab5582904158">More...</a><br /></td></tr>
<tr class="separator:a2715284d0c0504a041a9ab5582904158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e514222ba1fc83f777e4a6c65a6cdc"><td class="memTemplParams" colspan="2">template&lt;typename P &gt; </td></tr>
<tr class="memitem:a44e514222ba1fc83f777e4a6c65a6cdc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a44e514222ba1fc83f777e4a6c65a6cdc">getPolicy</a> (P &amp;&amp;p) const</td></tr>
<tr class="memdesc:a44e514222ba1fc83f777e4a6c65a6cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes in a vector all probabilities of the policy.  <a href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#a44e514222ba1fc83f777e4a6c65a6cdc">More...</a><br /></td></tr>
<tr class="separator:a44e514222ba1fc83f777e4a6c65a6cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename V, typename Gen&gt;<br />
class AIToolbox::Bandit::QSoftmaxPolicyWrapper&lt; V, Gen &gt;</h3>

<p>This class implements some basic softmax policy primitives. </p>
<p>Since the basic operations on discrete vectors to select an action with softmax are the same both in Bandits and in MDPs, we implement them once here. This class operates on references, so that it does not need to allocate memory and we can keep using the most appropriate storage for whatever problem we are actually working on.</p>
<p>Note that you shouldn't really need to specify the template parameters by hand. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a97bf2be1d43f0cfd1d8cf355ff3cadfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97bf2be1d43f0cfd1d8cf355ff3cadfc">&#9670;&nbsp;</a></span>QSoftmaxPolicyWrapper()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename V , typename Gen &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html">AIToolbox::Bandit::QSoftmaxPolicyWrapper</a>&lt; V, Gen &gt;::<a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html">QSoftmaxPolicyWrapper</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">V&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>valueBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Gen &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The temperature to use. </td></tr>
    <tr><td class="paramname">q</td><td>A reference to the QFunction to use. </td></tr>
    <tr><td class="paramname">valueBuffer</td><td>A buffer to compute softmax values. </td></tr>
    <tr><td class="paramname">buffer</td><td>A buffer to determine which action to take in case of equalities. </td></tr>
    <tr><td class="paramname">gen</td><td>A random engine. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2715284d0c0504a041a9ab5582904158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2715284d0c0504a041a9ab5582904158">&#9670;&nbsp;</a></span>getActionProbability()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename V , typename Gen &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html">AIToolbox::Bandit::QSoftmaxPolicyWrapper</a>&lt; V, Gen &gt;::getActionProbability </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the probability of taking the specified action in the specified state. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html#ab5ea841adc833c165a89c4869355a968" title="This function chooses an action for state s with probability dependent on value.">sampleAction()</a>;</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The selected action.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The probability of taking the specified action in the specified state. </dd></dl>

</div>
</div>
<a id="a44e514222ba1fc83f777e4a6c65a6cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e514222ba1fc83f777e4a6c65a6cdc">&#9670;&nbsp;</a></span>getPolicy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename V , typename Gen &gt; </div>
<div class="memtemplate">
template&lt;typename P &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html">AIToolbox::Bandit::QSoftmaxPolicyWrapper</a>&lt; V, Gen &gt;::getPolicy </td>
          <td>(</td>
          <td class="paramtype">P &amp;&amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes in a vector all probabilities of the policy. </p>
<p>Ideally this function can be called only when there is a repeated need to access the same policy values in an efficient manner. </p>

</div>
</div>
<a id="ab5ea841adc833c165a89c4869355a968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5ea841adc833c165a89c4869355a968">&#9670;&nbsp;</a></span>sampleAction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename V , typename Gen &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classAIToolbox_1_1Bandit_1_1QSoftmaxPolicyWrapper.html">AIToolbox::Bandit::QSoftmaxPolicyWrapper</a>&lt; V, Gen &gt;::sampleAction</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function chooses an action for state s with probability dependent on value. </p>
<p>This class implements softmax through the Boltzmann distribution. Thus an action will be chosen with probability:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ P(a) = \frac{e^{(Q(a)/t)})}{\sum_b{e^{(Q(b)/t)}}} \]" src="form_1.png"/>
</p>
<p>where t is the temperature. This value is not cached anywhere, so continuous sampling may not be extremely fast.</p>
<dl class="section return"><dt>Returns</dt><dd>The chosen action. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/AIToolbox/Bandit/Policies/Utils/<a class="el" href="QSoftmaxPolicyWrapper_8hpp_source.html">QSoftmaxPolicyWrapper.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
