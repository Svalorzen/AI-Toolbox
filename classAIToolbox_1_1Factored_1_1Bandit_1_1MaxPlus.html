<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIToolbox: AIToolbox::Factored::Bandit::MaxPlus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIToolbox
   </div>
   <div id="projectbrief">A library that offers tools for AI problem solving.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AIToolbox::Factored::Bandit::MaxPlus Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class represents the Max-Plus optimization algorithm for loopy FactorGraphs.  
 <a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MaxPlus_8hpp_source.html">AIToolbox/Factored/Bandit/Algorithms/Utils/MaxPlus.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a8d10135dc0887cf2067f4e1352b50c83"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a8d10135dc0887cf2067f4e1352b50c83">Result</a> = std::tuple&lt; <a class="el" href="namespaceAIToolbox_1_1Factored.html#aa30fc73167a9c8e913053059e23f9692">Action</a>, double &gt;</td></tr>
<tr class="separator:a8d10135dc0887cf2067f4e1352b50c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db554b0dd9b47a102eda3489c078e95"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5db554b0dd9b47a102eda3489c078e95">Graph</a> = <a class="el" href="classAIToolbox_1_1Factored_1_1FactorGraph.html">FactorGraph</a>&lt; <a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a> &gt;</td></tr>
<tr class="separator:a5db554b0dd9b47a102eda3489c078e95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:addbe68be22bebce105fa7524d0b61447"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#addbe68be22bebce105fa7524d0b61447">MaxPlus</a> (unsigned iterations=10)</td></tr>
<tr class="memdesc:addbe68be22bebce105fa7524d0b61447"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#addbe68be22bebce105fa7524d0b61447">More...</a><br /></td></tr>
<tr class="separator:addbe68be22bebce105fa7524d0b61447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbcd4502ec1363586e15a8e6b3afe0c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a8d10135dc0887cf2067f4e1352b50c83">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#adbcd4502ec1363586e15a8e6b3afe0c8">operator()</a> (const <a class="el" href="namespaceAIToolbox_1_1Factored.html#aa30fc73167a9c8e913053059e23f9692">Action</a> &amp;A, const <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5db554b0dd9b47a102eda3489c078e95">Graph</a> &amp;graph)</td></tr>
<tr class="memdesc:adbcd4502ec1363586e15a8e6b3afe0c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs the actual <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html" title="This class represents the Max-Plus optimization algorithm for loopy FactorGraphs.">MaxPlus</a> algorithm.  <a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#adbcd4502ec1363586e15a8e6b3afe0c8">More...</a><br /></td></tr>
<tr class="separator:adbcd4502ec1363586e15a8e6b3afe0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a749ff4f446ac521faabd38e4049b5144"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a749ff4f446ac521faabd38e4049b5144">getIterations</a> () const</td></tr>
<tr class="memdesc:a749ff4f446ac521faabd38e4049b5144"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the currently set number of message passes to perform.  <a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a749ff4f446ac521faabd38e4049b5144">More...</a><br /></td></tr>
<tr class="separator:a749ff4f446ac521faabd38e4049b5144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5721fd3d40aaeaac74f173fde81a1874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5721fd3d40aaeaac74f173fde81a1874">setIterations</a> (unsigned iterations)</td></tr>
<tr class="memdesc:a5721fd3d40aaeaac74f173fde81a1874"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the number of message passes to perform.  <a href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5721fd3d40aaeaac74f173fde81a1874">More...</a><br /></td></tr>
<tr class="separator:a5721fd3d40aaeaac74f173fde81a1874"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class represents the Max-Plus optimization algorithm for loopy FactorGraphs. </p>
<p>Max-Plus is the equivalent algorithm to the max-product algorithm for Bayesian networks. It is used to (in graphs, approximately) compute the optimal joint action for multiple agents very quickly.</p>
<p>Max-Plus works by sending messages between the agents and factors in the <a class="el" href="classAIToolbox_1_1Factored_1_1FactorGraph.html" title="This class offers a minimal interface to manager a factor graph.">FactorGraph</a> representation of the coordination problem. While algorithms like <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1VariableElimination.html" title="This class represents the Variable Elimination algorithm.">VariableElimination</a> postpone the actual maximization until the end, <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html" title="This class represents the Max-Plus optimization algorithm for loopy FactorGraphs.">MaxPlus</a> performs local maximizations repeatedly until convergence. Since local maximizations are performed on relatively small functions (and can possibly be done in parallel), <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html" title="This class represents the Max-Plus optimization algorithm for loopy FactorGraphs.">MaxPlus</a> is quite fast, although it cannot guarantee convergence in loopy graphs.</p>
<p>Agent nodes simply send to each adjacent factor the sum of all messages received from the other ones (so it excludes the message received by that same factor).</p>
<p>Factor nodes add their own original function to the cross-product of all received messages. Then, to each adjacent agent they send a message where all other agents are maximized.</p>
<p>The optimal action is selected locally by the agent nodes, by simply selecting the action that maximizes the sum of all received messages. Since in loopy graphs this is not guaranteed to convergence, we only update the returned action if the new overall value is greater than what was selected before.</p>
<p>Note: the way this algoritm is implemented, it assumes that an unique max always exists. If there are multiple, the algorithm will likely fail to identify any of them. This can in principle be fixed for graphs without cycles, but cannot be fixed for graphs with cycles (and indeed trying to do so can be arbitrarily bad). Thus we simply ignore the problem, and we require that the graph has a unique max. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a5db554b0dd9b47a102eda3489c078e95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db554b0dd9b47a102eda3489c078e95">&#9670;&nbsp;</a></span>Graph</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5db554b0dd9b47a102eda3489c078e95">AIToolbox::Factored::Bandit::MaxPlus::Graph</a> =  <a class="el" href="classAIToolbox_1_1Factored_1_1FactorGraph.html">FactorGraph</a>&lt;<a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d10135dc0887cf2067f4e1352b50c83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d10135dc0887cf2067f4e1352b50c83">&#9670;&nbsp;</a></span>Result</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a8d10135dc0887cf2067f4e1352b50c83">AIToolbox::Factored::Bandit::MaxPlus::Result</a> =  std::tuple&lt;<a class="el" href="namespaceAIToolbox_1_1Factored.html#aa30fc73167a9c8e913053059e23f9692">Action</a>, double&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="addbe68be22bebce105fa7524d0b61447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addbe68be22bebce105fa7524d0b61447">&#9670;&nbsp;</a></span>MaxPlus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AIToolbox::Factored::Bandit::MaxPlus::MaxPlus </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>10</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iterations</td><td>The default number of message passes to perform when solving. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a749ff4f446ac521faabd38e4049b5144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a749ff4f446ac521faabd38e4049b5144">&#9670;&nbsp;</a></span>getIterations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned AIToolbox::Factored::Bandit::MaxPlus::getIterations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the currently set number of message passes to perform. </p>

</div>
</div>
<a id="adbcd4502ec1363586e15a8e6b3afe0c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbcd4502ec1363586e15a8e6b3afe0c8">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a8d10135dc0887cf2067f4e1352b50c83">Result</a> AIToolbox::Factored::Bandit::MaxPlus::operator() </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceAIToolbox_1_1Factored.html#aa30fc73167a9c8e913053059e23f9692">Action</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html#a5db554b0dd9b47a102eda3489c078e95">Graph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs the actual <a class="el" href="classAIToolbox_1_1Factored_1_1Bandit_1_1MaxPlus.html" title="This class represents the Max-Plus optimization algorithm for loopy FactorGraphs.">MaxPlus</a> algorithm. </p>
<p>We maintain two matrices, inMessages and outMessages, which represent the messages sent by agents, and by factors respectively. At the end of each iteration the two are swapped.</p>
<p>For each agent, its adjacent factors, and the agents adjacent to those are found. Then all possible action combinations between those other agents are tried in order to find the best action response be for the agent to be eliminated.</p>
<p>All the best responses found are added as Rules to a (possibly new) factor adjacent to the adjacent agents.</p>
<p>The process is repeated until all agents are eliminated.</p>
<p>What remains is then joined into a single Action, containing the best possible value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The action space of the agents. </td></tr>
    <tr><td class="paramname">graph</td><td>The graph to perform VE on.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The pair for best Action and its value given the internal graph. </dd></dl>

</div>
</div>
<a id="a5721fd3d40aaeaac74f173fde81a1874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5721fd3d40aaeaac74f173fde81a1874">&#9670;&nbsp;</a></span>setIterations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::Factored::Bandit::MaxPlus::setIterations </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>iterations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the number of message passes to perform. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/AIToolbox/Factored/Bandit/Algorithms/Utils/<a class="el" href="MaxPlus_8hpp_source.html">MaxPlus.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
