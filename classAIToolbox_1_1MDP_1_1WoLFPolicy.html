<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIToolbox: AIToolbox::MDP::WoLFPolicy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIToolbox
   </div>
   <div id="projectbrief">A library that offers tools for AI problem solving.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classAIToolbox_1_1MDP_1_1WoLFPolicy.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAIToolbox_1_1MDP_1_1WoLFPolicy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AIToolbox::MDP::WoLFPolicy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class models the WoLF learning algorithm.  
 <a href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="WoLFPolicy_8hpp_source.html">WoLFPolicy.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for AIToolbox::MDP::WoLFPolicy:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classAIToolbox_1_1MDP_1_1WoLFPolicy.png" usemap="#AIToolbox::MDP::WoLFPolicy_map" alt=""/>
  <map id="AIToolbox::MDP::WoLFPolicy_map" name="AIToolbox::MDP::WoLFPolicy_map">
<area href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html" title="This class is an interface to specify a policy through a QFunction. " alt="AIToolbox::MDP::QPolicyInterface" shape="rect" coords="0,112,297,136"/>
<area href="classAIToolbox_1_1MDP_1_1PolicyInterface.html" title="Simple typedef for most of MDP&#39;s policy needs. " alt="AIToolbox::MDP::PolicyInterface" shape="rect" coords="0,56,297,80"/>
<area href="classAIToolbox_1_1PolicyInterface.html" alt="AIToolbox::PolicyInterface&lt; size_t, size_t, size_t &gt;" shape="rect" coords="0,0,297,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5da7647741afda3a435534a1a423c5b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#a5da7647741afda3a435534a1a423c5b2">WoLFPolicy</a> (const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;q, double deltaw=0.0125, double deltal=0.05, double scaling=5000.0)</td></tr>
<tr class="memdesc:a5da7647741afda3a435534a1a423c5b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="#a5da7647741afda3a435534a1a423c5b2">More...</a><br /></td></tr>
<tr class="separator:a5da7647741afda3a435534a1a423c5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfdbe8f719f98278f76370b915a262d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#acfdbe8f719f98278f76370b915a262d3">stepUpdateP</a> (size_t s)</td></tr>
<tr class="memdesc:acfdbe8f719f98278f76370b915a262d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function updates the WoLF policy based on changes in the QFunction.  <a href="#acfdbe8f719f98278f76370b915a262d3">More...</a><br /></td></tr>
<tr class="separator:acfdbe8f719f98278f76370b915a262d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abad70f10b1461617509e747bf8b192df"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#abad70f10b1461617509e747bf8b192df">sampleAction</a> (const size_t &amp;s) const override</td></tr>
<tr class="memdesc:abad70f10b1461617509e747bf8b192df"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function chooses an action for state s, following the policy distribution.  <a href="#abad70f10b1461617509e747bf8b192df">More...</a><br /></td></tr>
<tr class="separator:abad70f10b1461617509e747bf8b192df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7928b72817a695dbbedb11a805b3c21"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#ae7928b72817a695dbbedb11a805b3c21">getActionProbability</a> (const size_t &amp;s, const size_t &amp;a) const override</td></tr>
<tr class="memdesc:ae7928b72817a695dbbedb11a805b3c21"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the probability of taking the specified action in the specified state.  <a href="#ae7928b72817a695dbbedb11a805b3c21">More...</a><br /></td></tr>
<tr class="separator:ae7928b72817a695dbbedb11a805b3c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a97800dda7f203da0623774ec7f487f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceAIToolbox.html#a9d66d3e9eba8d23aeef6c6b865b6965a">Matrix2D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#a0a97800dda7f203da0623774ec7f487f">getPolicy</a> () const override</td></tr>
<tr class="memdesc:a0a97800dda7f203da0623774ec7f487f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a matrix containing all probabilities of the policy.  <a href="#a0a97800dda7f203da0623774ec7f487f">More...</a><br /></td></tr>
<tr class="separator:a0a97800dda7f203da0623774ec7f487f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80cfa2da7dae6f208638e2ccee51132"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#ac80cfa2da7dae6f208638e2ccee51132">setDeltaW</a> (double deltaW)</td></tr>
<tr class="memdesc:ac80cfa2da7dae6f208638e2ccee51132"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the new learning rate if winning.  <a href="#ac80cfa2da7dae6f208638e2ccee51132">More...</a><br /></td></tr>
<tr class="separator:ac80cfa2da7dae6f208638e2ccee51132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa655065c001b564558715907720519b9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#aa655065c001b564558715907720519b9">getDeltaW</a> () const</td></tr>
<tr class="memdesc:aa655065c001b564558715907720519b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the current learning rate during winning.  <a href="#aa655065c001b564558715907720519b9">More...</a><br /></td></tr>
<tr class="separator:aa655065c001b564558715907720519b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626b52d59d56b032033950b729250f57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#a626b52d59d56b032033950b729250f57">setDeltaL</a> (double deltaL)</td></tr>
<tr class="memdesc:a626b52d59d56b032033950b729250f57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the new learning rate if losing.  <a href="#a626b52d59d56b032033950b729250f57">More...</a><br /></td></tr>
<tr class="separator:a626b52d59d56b032033950b729250f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2504f7fb9208ca90a027e624952b4854"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#a2504f7fb9208ca90a027e624952b4854">getDeltaL</a> () const</td></tr>
<tr class="memdesc:a2504f7fb9208ca90a027e624952b4854"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the current learning rate during loss.  <a href="#a2504f7fb9208ca90a027e624952b4854">More...</a><br /></td></tr>
<tr class="separator:a2504f7fb9208ca90a027e624952b4854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17c250bc69fd275546c837fcbe15baa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#ac17c250bc69fd275546c837fcbe15baa">setScaling</a> (double scaling)</td></tr>
<tr class="memdesc:ac17c250bc69fd275546c837fcbe15baa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function modifies the scaling parameter.  <a href="#ac17c250bc69fd275546c837fcbe15baa">More...</a><br /></td></tr>
<tr class="separator:ac17c250bc69fd275546c837fcbe15baa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89421ede3a7ac69d6b81f1c2d6813fa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html#aa89421ede3a7ac69d6b81f1c2d6813fa">getScaling</a> () const</td></tr>
<tr class="memdesc:aa89421ede3a7ac69d6b81f1c2d6813fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the current scaling parameter.  <a href="#aa89421ede3a7ac69d6b81f1c2d6813fa">More...</a><br /></td></tr>
<tr class="separator:aa89421ede3a7ac69d6b81f1c2d6813fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html">AIToolbox::MDP::QPolicyInterface</a></td></tr>
<tr class="memitem:adfab9bef8960e29735bcdaa2c8aa286f inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html#adfab9bef8960e29735bcdaa2c8aa286f">QPolicyInterface</a> (const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;q)</td></tr>
<tr class="memdesc:adfab9bef8960e29735bcdaa2c8aa286f inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html#adfab9bef8960e29735bcdaa2c8aa286f">More...</a><br /></td></tr>
<tr class="separator:adfab9bef8960e29735bcdaa2c8aa286f inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487b8365b7eca7a738a22a542287f7c6 inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html#a487b8365b7eca7a738a22a542287f7c6">getQFunction</a> () const</td></tr>
<tr class="memdesc:a487b8365b7eca7a738a22a542287f7c6 inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the underlying QFunction reference.  <a href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html#a487b8365b7eca7a738a22a542287f7c6">More...</a><br /></td></tr>
<tr class="separator:a487b8365b7eca7a738a22a542287f7c6 inherit pub_methods_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classAIToolbox_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAIToolbox_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface&lt; size_t, size_t, size_t &gt;</a></td></tr>
<tr class="memitem:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a68923fb951ce7c2bb27a97eba4afcb73">PolicyInterface</a> (size_t s, size_t a)</td></tr>
<tr class="memdesc:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1PolicyInterface.html#a68923fb951ce7c2bb27a97eba4afcb73">More...</a><br /></td></tr>
<tr class="separator:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a9fccdc78f246f0da0e1d9cc64a1a846c">~PolicyInterface</a> ()</td></tr>
<tr class="memdesc:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic virtual destructor.  <a href="classAIToolbox_1_1PolicyInterface.html#a9fccdc78f246f0da0e1d9cc64a1a846c">More...</a><br /></td></tr>
<tr class="separator:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">const size_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#af63551eecbcccc433e107bfe72bff4ae">getS</a> () const</td></tr>
<tr class="memdesc:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of states of the world.  <a href="classAIToolbox_1_1PolicyInterface.html#af63551eecbcccc433e107bfe72bff4ae">More...</a><br /></td></tr>
<tr class="separator:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">const size_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a6d7be17c43fbf6517b052bd57cb428a7">getA</a> () const</td></tr>
<tr class="memdesc:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of available actions to the agent.  <a href="classAIToolbox_1_1PolicyInterface.html#a6d7be17c43fbf6517b052bd57cb428a7">More...</a><br /></td></tr>
<tr class="separator:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classAIToolbox_1_1MDP_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classAIToolbox_1_1MDP_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classAIToolbox_1_1MDP_1_1PolicyInterface.html">AIToolbox::MDP::PolicyInterface</a></td></tr>
<tr class="memitem:ae10f920bd58bd6fa87355cbaf998192a inherit pub_types_classAIToolbox_1_1MDP_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1PolicyInterface.html#ae10f920bd58bd6fa87355cbaf998192a">Base</a> = <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface</a>&lt; size_t, size_t, size_t &gt;</td></tr>
<tr class="separator:ae10f920bd58bd6fa87355cbaf998192a inherit pub_types_classAIToolbox_1_1MDP_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classAIToolbox_1_1MDP_1_1QPolicyInterface')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html">AIToolbox::MDP::QPolicyInterface</a></td></tr>
<tr class="memitem:a8839415f6249ba9e9af49437b1604f98 inherit pro_attribs_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1MDP_1_1QPolicyInterface.html#a8839415f6249ba9e9af49437b1604f98">q_</a></td></tr>
<tr class="separator:a8839415f6249ba9e9af49437b1604f98 inherit pro_attribs_classAIToolbox_1_1MDP_1_1QPolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classAIToolbox_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classAIToolbox_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface&lt; size_t, size_t, size_t &gt;</a></td></tr>
<tr class="memitem:afc3dfcb0c94294b3de303ac948cf7a21 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#afc3dfcb0c94294b3de303ac948cf7a21">S</a></td></tr>
<tr class="separator:afc3dfcb0c94294b3de303ac948cf7a21 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca23b903636afd69b099f8db7fc39658 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#aca23b903636afd69b099f8db7fc39658">A</a></td></tr>
<tr class="separator:aca23b903636afd69b099f8db7fc39658 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6975c6f8f853035f3fb4d624bdfca41d inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceAIToolbox.html#a09b5db736a97adb3698ffa04ea3f4aa4">RandomEngine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a6975c6f8f853035f3fb4d624bdfca41d">rand_</a></td></tr>
<tr class="separator:a6975c6f8f853035f3fb4d624bdfca41d inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class models the WoLF learning algorithm. </p>
<p>What this algorithm does is it progressively modifies the policy given changes in the underlying QFunction. In particular, it modifies it rapidly if the agent is "losing" (getting less reward than expected), and more slowly when "winning", since there's little reason to change behaviour when things go right.</p>
<p>An advantage of this algorithm is that it can allow the policy to converge to non-deterministic solutions: for example two players trying to outmatch each other in rock-paper-scissor. At the same time, this particular version of the algorithm can take quite some time to converge to a good solution. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5da7647741afda3a435534a1a423c5b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5da7647741afda3a435534a1a423c5b2">&#9670;&nbsp;</a></span>WoLFPolicy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AIToolbox::MDP::WoLFPolicy::WoLFPolicy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceAIToolbox_1_1MDP.html#a7511ad35cec2e20bf392458125e28ebc">QFunction</a> &amp;&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaw</em> = <code>0.0125</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltal</em> = <code>0.05</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scaling</em> = <code>5000.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<p>See the setter functions to see what the parameters do.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>The QFunction from which to extract policy updates. </td></tr>
    <tr><td class="paramname">deltaw</td><td>The learning rate if this policy is currently winning. </td></tr>
    <tr><td class="paramname">deltal</td><td>The learning rate if this policy is currently losing. </td></tr>
    <tr><td class="paramname">scaling</td><td>The initial scaling rate to progressively reduce the learning rates. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae7928b72817a695dbbedb11a805b3c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7928b72817a695dbbedb11a805b3c21">&#9670;&nbsp;</a></span>getActionProbability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double AIToolbox::MDP::WoLFPolicy::getActionProbability </td>
          <td>(</td>
          <td class="paramtype">const size_t &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t &amp;&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the probability of taking the specified action in the specified state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The selected state. </td></tr>
    <tr><td class="paramname">a</td><td>The selected action.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The probability of taking the selected action in the specified state. </dd></dl>

<p>Implements <a class="el" href="classAIToolbox_1_1PolicyInterface.html#abd87203abf911c7247ad769bf60db3f2">AIToolbox::PolicyInterface&lt; size_t, size_t, size_t &gt;</a>.</p>

</div>
</div>
<a id="a2504f7fb9208ca90a027e624952b4854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2504f7fb9208ca90a027e624952b4854">&#9670;&nbsp;</a></span>getDeltaL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AIToolbox::MDP::WoLFPolicy::getDeltaL </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the current learning rate during loss. </p>
<dl class="section return"><dt>Returns</dt><dd>The learning rate during loss. </dd></dl>

</div>
</div>
<a id="aa655065c001b564558715907720519b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa655065c001b564558715907720519b9">&#9670;&nbsp;</a></span>getDeltaW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AIToolbox::MDP::WoLFPolicy::getDeltaW </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the current learning rate during winning. </p>
<dl class="section return"><dt>Returns</dt><dd>The learning rate during winning. </dd></dl>

</div>
</div>
<a id="a0a97800dda7f203da0623774ec7f487f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a97800dda7f203da0623774ec7f487f">&#9670;&nbsp;</a></span>getPolicy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceAIToolbox.html#a9d66d3e9eba8d23aeef6c6b865b6965a">Matrix2D</a> AIToolbox::MDP::WoLFPolicy::getPolicy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns a matrix containing all probabilities of the policy. </p>
<p>Ideally this function can be called only when there is a repeated need to access the same policy values in an efficient manner. </p>

<p>Implements <a class="el" href="classAIToolbox_1_1MDP_1_1PolicyInterface.html#ad79b9ffabb4fd29f6e2207fa12bc23ed">AIToolbox::MDP::PolicyInterface</a>.</p>

</div>
</div>
<a id="aa89421ede3a7ac69d6b81f1c2d6813fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89421ede3a7ac69d6b81f1c2d6813fa">&#9670;&nbsp;</a></span>getScaling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AIToolbox::MDP::WoLFPolicy::getScaling </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the current scaling parameter. </p>
<dl class="section return"><dt>Returns</dt><dd>The current scaling parameter. </dd></dl>

</div>
</div>
<a id="abad70f10b1461617509e747bf8b192df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abad70f10b1461617509e747bf8b192df">&#9670;&nbsp;</a></span>sampleAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t AIToolbox::MDP::WoLFPolicy::sampleAction </td>
          <td>(</td>
          <td class="paramtype">const size_t &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function chooses an action for state s, following the policy distribution. </p>
<p>Note that to improve learning it may be useful to wrap this policy into an <a class="el" href="classAIToolbox_1_1MDP_1_1EpsilonPolicy.html">EpsilonPolicy</a> in order to provide some exploration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The sampled state of the policy.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The chosen action. </dd></dl>

<p>Implements <a class="el" href="classAIToolbox_1_1PolicyInterface.html#a460920496b63af5a7f71aa25dc3c35da">AIToolbox::PolicyInterface&lt; size_t, size_t, size_t &gt;</a>.</p>

</div>
</div>
<a id="a626b52d59d56b032033950b729250f57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a626b52d59d56b032033950b729250f57">&#9670;&nbsp;</a></span>setDeltaL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::WoLFPolicy::setDeltaL </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaL</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the new learning rate if losing. </p>
<p>This is the amount that the policy is modified when the updatePolicy() function is called when <a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html" title="This class models the WoLF learning algorithm. ">WoLFPolicy</a> determines that it is currently losing based on the current QFunction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">deltaL</td><td>The new learning rate during loss. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac80cfa2da7dae6f208638e2ccee51132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80cfa2da7dae6f208638e2ccee51132">&#9670;&nbsp;</a></span>setDeltaW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::WoLFPolicy::setDeltaW </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaW</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the new learning rate if winning. </p>
<p>This is the amount that the policy is modified when the updatePolicy() function is called when <a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html" title="This class models the WoLF learning algorithm. ">WoLFPolicy</a> determines that it is currently winning based on the current QFunction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">deltaW</td><td>The new learning rate during wins. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac17c250bc69fd275546c837fcbe15baa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17c250bc69fd275546c837fcbe15baa">&#9670;&nbsp;</a></span>setScaling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::WoLFPolicy::setScaling </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scaling</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function modifies the scaling parameter. </p>
<p>In order to be able to converge <a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html" title="This class models the WoLF learning algorithm. ">WoLFPolicy</a> needs to progressively reduce the learning rates over time. It does so automatically to avoid needing to call both learning rate setters constantly. This is also because in theory the learning rate should change per state, so it would be even harder to do outside.</p>
<p>Once determined if the policy is winning or losing, the selected learning rate is scaled with the following formula: </p><pre class="fragment">newLearningRate = originalLearningRate / ( c_[s] / scaling + 1 );
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scaling</td><td>The new scaling factor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acfdbe8f719f98278f76370b915a262d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfdbe8f719f98278f76370b915a262d3">&#9670;&nbsp;</a></span>stepUpdateP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AIToolbox::MDP::WoLFPolicy::stepUpdateP </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function updates the WoLF policy based on changes in the QFunction. </p>
<p>This function should be called between agent's actions, using the agent's current state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The state that needs to be updated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/AIToolbox/MDP/Policies/<a class="el" href="WoLFPolicy_8hpp_source.html">WoLFPolicy.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceAIToolbox.html">AIToolbox</a></li><li class="navelem"><a class="el" href="namespaceAIToolbox_1_1MDP.html">MDP</a></li><li class="navelem"><a class="el" href="classAIToolbox_1_1MDP_1_1WoLFPolicy.html">WoLFPolicy</a></li>
    <li class="footer">Generated on Sat Mar 7 2020 21:49:58 for AIToolbox by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
