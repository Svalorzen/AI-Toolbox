<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AIToolbox: AIToolbox::Bandit::TopTwoThompsonSamplingPolicy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AIToolbox
   </div>
   <div id="projectbrief">A library that offers tools for AI problem solving.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AIToolbox::Bandit::TopTwoThompsonSamplingPolicy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements the top-two Thompson sampling policy.  
 <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="TopTwoThompsonSamplingPolicy_8hpp_source.html">AIToolbox/Bandit/Policies/TopTwoThompsonSamplingPolicy.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for AIToolbox::Bandit::TopTwoThompsonSamplingPolicy:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.png" usemap="#AIToolbox::Bandit::TopTwoThompsonSamplingPolicy_map" alt=""/>
  <map id="AIToolbox::Bandit::TopTwoThompsonSamplingPolicy_map" name="AIToolbox::Bandit::TopTwoThompsonSamplingPolicy_map">
<area href="classAIToolbox_1_1Bandit_1_1PolicyInterface.html" title="Simple typedef for most of a normal Bandit&#39;s policy needs." alt="AIToolbox::Bandit::PolicyInterface" shape="rect" coords="0,56,302,80"/>
<area href="classAIToolbox_1_1PolicyInterface.html" alt="AIToolbox::PolicyInterface&lt; void, void, size_t &gt;" shape="rect" coords="0,0,302,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abf698eb832912906e23f13b0b8d51ece"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#abf698eb832912906e23f13b0b8d51ece">TopTwoThompsonSamplingPolicy</a> (const <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html">Experience</a> &amp;exp, double beta)</td></tr>
<tr class="memdesc:abf698eb832912906e23f13b0b8d51ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#abf698eb832912906e23f13b0b8d51ece">More...</a><br /></td></tr>
<tr class="separator:abf698eb832912906e23f13b0b8d51ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee86511b6a1d5bbe17d707cfb262a8d"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aaee86511b6a1d5bbe17d707cfb262a8d">sampleAction</a> () const override</td></tr>
<tr class="memdesc:aaee86511b6a1d5bbe17d707cfb262a8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function chooses an action using top-two Thompson sampling.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aaee86511b6a1d5bbe17d707cfb262a8d">More...</a><br /></td></tr>
<tr class="separator:aaee86511b6a1d5bbe17d707cfb262a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e622112f0d3fb6b94073ff850a1068"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a66e622112f0d3fb6b94073ff850a1068">recommendAction</a> () const</td></tr>
<tr class="memdesc:a66e622112f0d3fb6b94073ff850a1068"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the most likely best action until this point.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a66e622112f0d3fb6b94073ff850a1068">More...</a><br /></td></tr>
<tr class="separator:a66e622112f0d3fb6b94073ff850a1068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b3ac3b1aadb97de1195b6635ee3f28"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aa2b3ac3b1aadb97de1195b6635ee3f28">getActionProbability</a> (const size_t &amp;a) const override</td></tr>
<tr class="memdesc:aa2b3ac3b1aadb97de1195b6635ee3f28"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the probability of taking the specified action.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aa2b3ac3b1aadb97de1195b6635ee3f28">More...</a><br /></td></tr>
<tr class="separator:aa2b3ac3b1aadb97de1195b6635ee3f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282a4aeaaa80ddeb3ba21cffa02b4b4e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a282a4aeaaa80ddeb3ba21cffa02b4b4e">getPolicy</a> () const override</td></tr>
<tr class="memdesc:a282a4aeaaa80ddeb3ba21cffa02b4b4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a vector containing all probabilities of the policy.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a282a4aeaaa80ddeb3ba21cffa02b4b4e">More...</a><br /></td></tr>
<tr class="separator:a282a4aeaaa80ddeb3ba21cffa02b4b4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338313601225eb40178a1cb80232ce1b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html">Experience</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a338313601225eb40178a1cb80232ce1b">getExperience</a> () const</td></tr>
<tr class="memdesc:a338313601225eb40178a1cb80232ce1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a reference to the underlying <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html" title="This class computes averages and counts for a Bandit problem.">Experience</a> we use.  <a href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#a338313601225eb40178a1cb80232ce1b">More...</a><br /></td></tr>
<tr class="separator:a338313601225eb40178a1cb80232ce1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classAIToolbox_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAIToolbox_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface&lt; void, void, size_t &gt;</a></td></tr>
<tr class="memitem:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a68923fb951ce7c2bb27a97eba4afcb73">PolicyInterface</a> (void s, size_t a)</td></tr>
<tr class="memdesc:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic constructor.  <a href="classAIToolbox_1_1PolicyInterface.html#a68923fb951ce7c2bb27a97eba4afcb73">More...</a><br /></td></tr>
<tr class="separator:a68923fb951ce7c2bb27a97eba4afcb73 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a9fccdc78f246f0da0e1d9cc64a1a846c">~PolicyInterface</a> ()</td></tr>
<tr class="memdesc:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic virtual destructor.  <a href="classAIToolbox_1_1PolicyInterface.html#a9fccdc78f246f0da0e1d9cc64a1a846c">More...</a><br /></td></tr>
<tr class="separator:a9fccdc78f246f0da0e1d9cc64a1a846c inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a460920496b63af5a7f71aa25dc3c35da inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a460920496b63af5a7f71aa25dc3c35da">sampleAction</a> (const void &amp;s) const=0</td></tr>
<tr class="memdesc:a460920496b63af5a7f71aa25dc3c35da inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function chooses a random action for state s, following the policy distribution.  <a href="classAIToolbox_1_1PolicyInterface.html#a460920496b63af5a7f71aa25dc3c35da">More...</a><br /></td></tr>
<tr class="separator:a460920496b63af5a7f71aa25dc3c35da inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd87203abf911c7247ad769bf60db3f2 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#abd87203abf911c7247ad769bf60db3f2">getActionProbability</a> (const void &amp;s, const size_t &amp;a) const=0</td></tr>
<tr class="memdesc:abd87203abf911c7247ad769bf60db3f2 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the probability of taking the specified action in the specified state.  <a href="classAIToolbox_1_1PolicyInterface.html#abd87203abf911c7247ad769bf60db3f2">More...</a><br /></td></tr>
<tr class="separator:abd87203abf911c7247ad769bf60db3f2 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">const void &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#af63551eecbcccc433e107bfe72bff4ae">getS</a> () const</td></tr>
<tr class="memdesc:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of states of the world.  <a href="classAIToolbox_1_1PolicyInterface.html#af63551eecbcccc433e107bfe72bff4ae">More...</a><br /></td></tr>
<tr class="separator:af63551eecbcccc433e107bfe72bff4ae inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">const size_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a6d7be17c43fbf6517b052bd57cb428a7">getA</a> () const</td></tr>
<tr class="memdesc:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the number of available actions to the agent.  <a href="classAIToolbox_1_1PolicyInterface.html#a6d7be17c43fbf6517b052bd57cb428a7">More...</a><br /></td></tr>
<tr class="separator:a6d7be17c43fbf6517b052bd57cb428a7 inherit pub_methods_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classAIToolbox_1_1Bandit_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classAIToolbox_1_1Bandit_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classAIToolbox_1_1Bandit_1_1PolicyInterface.html">AIToolbox::Bandit::PolicyInterface</a></td></tr>
<tr class="memitem:a821ed56c2402de320aa3355e869ec268 inherit pub_types_classAIToolbox_1_1Bandit_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1Bandit_1_1PolicyInterface.html#a821ed56c2402de320aa3355e869ec268">Base</a> = <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface</a>&lt; void, void, size_t &gt;</td></tr>
<tr class="separator:a821ed56c2402de320aa3355e869ec268 inherit pub_types_classAIToolbox_1_1Bandit_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classAIToolbox_1_1PolicyInterface"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classAIToolbox_1_1PolicyInterface')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classAIToolbox_1_1PolicyInterface.html">AIToolbox::PolicyInterface&lt; void, void, size_t &gt;</a></td></tr>
<tr class="memitem:afc3dfcb0c94294b3de303ac948cf7a21 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#afc3dfcb0c94294b3de303ac948cf7a21">S</a></td></tr>
<tr class="separator:afc3dfcb0c94294b3de303ac948cf7a21 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca23b903636afd69b099f8db7fc39658 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#aca23b903636afd69b099f8db7fc39658">A</a></td></tr>
<tr class="separator:aca23b903636afd69b099f8db7fc39658 inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6975c6f8f853035f3fb4d624bdfca41d inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceAIToolbox.html#a09b5db736a97adb3698ffa04ea3f4aa4">RandomEngine</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAIToolbox_1_1PolicyInterface.html#a6975c6f8f853035f3fb4d624bdfca41d">rand_</a></td></tr>
<tr class="separator:a6975c6f8f853035f3fb4d624bdfca41d inherit pro_attribs_classAIToolbox_1_1PolicyInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements the top-two Thompson sampling policy. </p>
<p>This class uses the Student-t distribution to model normally-distributed rewards with unknown mean and variance. As more experience is gained, each distribution becomes a Normal which models the mean of its respective arm.</p>
<p>The top-two Thompson sampling policy is designed to be used in a pure exploration setting. In other words, we wish to discover the best arm in the shortest possible time, without the need to minimize regret while doing so. This last part is the key difference to many bandit algorithms, that try to exploit their knowledge more and more as time goes on.</p>
<p>The way this works is by focusing arm pulls on the currently estimated top two arms, since those are the most likely to contend for the "title" of best arm. The two top arms are estimated using Thompson sampling. We first sample a first best action, and then, if needed, we keep sampling until a new, different best action is sampled.</p>
<p>We either take the first action sampled with probability beta, or the other with probability 1-beta. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abf698eb832912906e23f13b0b8d51ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf698eb832912906e23f13b0b8d51ece">&#9670;&nbsp;</a></span>TopTwoThompsonSamplingPolicy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::TopTwoThompsonSamplingPolicy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html">Experience</a> &amp;&#160;</td>
          <td class="paramname"><em>exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exp</td><td>The <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html" title="This class computes averages and counts for a Bandit problem.">Experience</a> we learn from. </td></tr>
    <tr><td class="paramname">beta</td><td>The probability of playing the first sampled best action instead of the second sampled best. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa2b3ac3b1aadb97de1195b6635ee3f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2b3ac3b1aadb97de1195b6635ee3f28">&#9670;&nbsp;</a></span>getActionProbability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::getActionProbability </td>
          <td>(</td>
          <td class="paramtype">const size_t &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the probability of taking the specified action. </p>
<p>WARNING: The only way to compute the true probability of selecting the input action is via empirical sampling. we simply call <a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aaee86511b6a1d5bbe17d707cfb262a8d" title="This function chooses an action using top-two Thompson sampling.">sampleAction()</a> a lot and return an approximation of the times the input action was actually selected. This makes this function very very SLOW. Do not call at will!!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The selected action.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function returns an approximation of the probability of choosing the input action. </dd></dl>

</div>
</div>
<a id="a338313601225eb40178a1cb80232ce1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a338313601225eb40178a1cb80232ce1b">&#9670;&nbsp;</a></span>getExperience()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html">Experience</a>&amp; AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::getExperience </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns a reference to the underlying <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html" title="This class computes averages and counts for a Bandit problem.">Experience</a> we use. </p>
<dl class="section return"><dt>Returns</dt><dd>The internal <a class="el" href="classAIToolbox_1_1Bandit_1_1Experience.html" title="This class computes averages and counts for a Bandit problem.">Experience</a> reference. </dd></dl>

</div>
</div>
<a id="a282a4aeaaa80ddeb3ba21cffa02b4b4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282a4aeaaa80ddeb3ba21cffa02b4b4e">&#9670;&nbsp;</a></span>getPolicy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceAIToolbox.html#a1e6976de7a0159cd1630c4f2553fc9f3">Vector</a> AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::getPolicy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns a vector containing all probabilities of the policy. </p>
<p>Ideally this function can be called only when there is a repeated need to access the same policy values in an efficient manner.</p>
<p>WARNING: This can be really expensive, as it does pretty much the same work as <a class="el" href="classAIToolbox_1_1Bandit_1_1TopTwoThompsonSamplingPolicy.html#aa2b3ac3b1aadb97de1195b6635ee3f28" title="This function returns the probability of taking the specified action.">getActionProbability()</a>. It shouldn't be slower than that call though, so if you do need the overall policy, do call this method. </p>

<p>Implements <a class="el" href="classAIToolbox_1_1Bandit_1_1PolicyInterface.html#abeefee27cf67fb697231263f49f00e57">AIToolbox::Bandit::PolicyInterface</a>.</p>

</div>
</div>
<a id="a66e622112f0d3fb6b94073ff850a1068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66e622112f0d3fb6b94073ff850a1068">&#9670;&nbsp;</a></span>recommendAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::recommendAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the most likely best action until this point. </p>
<dl class="section return"><dt>Returns</dt><dd>The most likely best action. </dd></dl>

</div>
</div>
<a id="aaee86511b6a1d5bbe17d707cfb262a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee86511b6a1d5bbe17d707cfb262a8d">&#9670;&nbsp;</a></span>sampleAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t AIToolbox::Bandit::TopTwoThompsonSamplingPolicy::sampleAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function chooses an action using top-two Thompson sampling. </p>
<dl class="section return"><dt>Returns</dt><dd>The chosen action. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/AIToolbox/Bandit/Policies/<a class="el" href="TopTwoThompsonSamplingPolicy_8hpp_source.html">TopTwoThompsonSamplingPolicy.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
